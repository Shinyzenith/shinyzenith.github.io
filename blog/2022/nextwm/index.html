<!doctype html><html><head><meta charset=utf-8><title>NextWM! Â· Shinyzenith</title><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=canonical href=https://aakash.is-a.dev/blog/2022/nextwm/><meta name=author content="Aakash Sen Sharma"><link rel=stylesheet href=https://aakash.is-a.dev/node_modules/normalize.css/normalize.css><link rel=stylesheet href=https://aakash.is-a.dev/node_modules/firacode/distr/fira_code.css><link rel=stylesheet href=https://aakash.is-a.dev/css/nanum-gothic-coding.css><link rel=stylesheet href=https://aakash.is-a.dev/css/style.css><script defer data-domain=aakash.is-a.dev src=https://analytics.is-a.dev/js/script.js></script></head><body><header><h1>ç©º</h1></header><div id=main><nav><a href=https://aakash.is-a.dev/>Home</a> &#183;
<a href=https://aakash.is-a.dev/blog>Blog</a> &#183;
<a rel=me href=https://aakash.is-a.dev/about>About</a> &#183;
<a rel=me href=https://github.com/shinyzenith>GitHub</a> &#183;
<a rel=me href=https://fosstodon.org/@shinyzenith>Mastodon</a></nav><main><article><header><h1>NextWM!</h1><time datetime=2022-06-04T00:00:00Z>2022-06-04</time></header><h1 id=choosing-a-language>Choosing a language:</h1><p>Hi! in my current quest of writing a useable wayland compositing window manager I have gone down a deep rabbit hole.</p><p>The wlroots repository lists the following wrapper libraries:</p><blockquote><p><code>Chicken Scheme</code>, <code>Common Lisp</code>, <code>Go</code>, <code>Godot</code>, <code>Haskell</code>, <code>OCaml</code>, <code>Python</code>, <code>Qt</code>, <code>Rust</code>, <code>Swift</code>, <code>Zig</code></p></blockquote><p>Don&rsquo;t be fooled by this list! All of these wrapper libraries are unmaintained apart from Python and Zig ðŸ˜”.</p><p>With the above in mind, I have tried multiple languages to write a compositor with and here are my cumulative thoughts:</p><h2 id=c>C:</h2><p>I simply don&rsquo;t want to write my compositor in C as it&rsquo;s easy to shoot yourself in the foot with it.</p><h2 id=c-1>C++:</h2><p>Same reasons as C, and on top of that importing wlroots headers into C++ in itself is a <a href=https://github.com/swaywm/wlroots/issues/682>messy</a> task
including prepocessor re-definitions etc.</p><h2 id=nim>Nim:</h2><p>It was initially working till it didn&rsquo;t&mldr;</p><p>I&rsquo;m still not quite sure why the <a href="https://github.com/Shinyzenith/nim-wl/blob/devel/src/libherb.nim#L125=">callbacks</a> that I had registered didn&rsquo;t work.</p><p>If you do, feel free to reach out to me via Email or via <a href=https://github.com/Shinyzenith/nim-wl/issues/new>GitHub issue</a>.</p><h2 id=zig>Zig:</h2><p>Zig is a fine language to use for compositors given the amazing work <a href=https://github.com/ifreund/>@Ifreund</a> has put in which includes but is not limited to:</p><ul><li><a href=https://github.com/ifreund/zig-pixman>Zig-pixman</a> - Pixman bindings.</li><li><a href=https://github.com/ifreund/zig-wayland>Zig-wayland</a> - Libwayland bindings.</li><li><a href=https://github.com/swaywm/zig-wlroots>Zig-wlroots</a> - Wlroots bindings.</li><li><a href=https://github.com/ifreund/zig-xkbcommon>Zig-xkbcommon</a> - Xkbcommon bindings.</li></ul><p>That being said, Zig is still an unstable language which hasn&rsquo;t even had a 1.0 release yet.</p><p>Hence I don&rsquo;t want to commit to writing my entire stack in Zig just yet.</p><p>I am however writing a small helper <a href=https://github.com/shinyzenith/zigshot>screenshot utility</a> in Zig (<a href=https://github.com/waycrate/wayshot>wayshot</a> clone) for
teaching myself and others who want to learn more about the wayland ecosystem.</p><h2 id=rust>Rust:</h2><blockquote><p>Although <strong>Smithay isn&rsquo;t the same as wlroots</strong>, it&rsquo;s still a worthy candidate to mention on this list due to the fact that you can write compositors
which are <strong>just as functional</strong> with it too.</p></blockquote><p>I&rsquo;ve recently started contributing to <a href=https://github.com/smithay/wayland-rs>wayland-rs</a> and <a href=https://github.com/smithay/client-toolkit>smithay-client-toolkit</a>
and you should too! they&rsquo;re in need of more contributors and as you can imagine, maintaining pure rust libwayland bindings is a herculean task.</p><blockquote><p>The devs have been nothing but patient with me even when I asked stupid questions over and over again in their matrix channel.</p></blockquote><p>All of my wayland knowledge comes from writing numerous wayland clients with wayland-rs and talking to <a href=https://github.com/cmeissl>cmeissl</a>,
<a href=https://github.com/i509VCB>i509VCB</a> and <a href=https://github.com/vberger>Victor Berger</a> from the smithay team.</p><p>That being said, Smithay just isn&rsquo;t as mature as wlroots yet. A lot more manual labor is needed just for the tinywl equivalent of wlroots in smithay&mldr;you
can assume how much it would scale up for a proper usable compositor (None written in smithay yet). This paird with the fact that the <strong>wayland-rs API
is undergoing a massive breaking change</strong> for release candidate <strong>0.3.0</strong>, makes it too volatile to commit to in terms of server side just yet.</p><blockquote><p>However, <strong>client side API won&rsquo;t change too</strong> much with release candidate 0.3.0 and I&rsquo;d say it&rsquo;s a pleasant experience to write wayland clients in rust.</p></blockquote><blockquote><p>On a separate note, check out the <a href=https://github.com/mahkoh/jay>Jay compositor</a>. I think the dev is on crack? they implemented practically everything
on their own:</p><ul><li>Wayland protocol.</li><li>Wire protocol.</li><li>Dbus interface.</li><li>EGL wrapper.</li><li>GBM wrapper.</li><li>OpenGL renderer.</li></ul><p>The project doesn&rsquo;t even depend on libwayland!!! ðŸ¤¯ðŸ¤¯ðŸ¤¯</p></blockquote><h2 id=python>Python:</h2><p>Python to me is a first class candidate for writing compositors. It&rsquo;s not easy to shoot yourself in the foot with, simple enough to write and most importantly,
it has <a href=https://github.com/flacjacket/pywlroots>maintained bindings</a>.</p><p>The question might arise &ldquo;What will you do when the bindings are no longer maintained?&rdquo;.</p><p>I don&rsquo;t think qtile will become irrelevant anytime soon hence the bindings will stay maintained for a long time.</p><p>&ldquo;What does qtile have to do with wlroots python bindings?&rdquo;, pywlroots and pywayland are both maintained by <a href=https://github.com/flacjacket>Sean Vig</a>
from the qtile team!</p><hr><h1 id=the-verdict>The Verdict:</h1><p>It should come of no surprise to you that <strong>I picked python</strong>. I have created the repo and invited a <a href=https://github.com/actualdankcoder>friend of mine</a>
to develop NextWM with me.</p><hr><h1 id=source-code-availability-and-support>Source Code Availability and Support:</h1><p>I will follow through with one of the following:</p><ol><li><p>Keep the source private until get paid to release it. If I do get paid, I will provide 100% support for the lifetime of the project. This is because
<strong>I&rsquo;m tired of offering my free labor</strong>, I write my software to <strong>teach myself and use in my workflow</strong> and not to provide support for other issues
which are irrelevant to my usecase.</p></li><li><p>Keep the code open-source under <a href=https://spdx.org/licenses/0BSD.html>0BSD license</a> and stop giving a fuck about bug reports/feature requests I
get which are irrelevant to me unless I get paid to escalate their priority. I made the mistake of caring too much with <a href=https://github.com/waycrate/swhkd>swhkd</a>
and instead got back github issues like such: <a href=https://github.com/waycrate/swhkd/issues/125>&ldquo;see man sxhkd to know other modifiers that sxhkd support instead of waiting people to report them one by one&rdquo;</a></p></li></ol><p>I&rsquo;m sorry but I wrote swhkd for my usecase as I needed a hotkey daemon and I bind features as and when requested if I don&rsquo;t need them already. I
don&rsquo;t like that attitude.</p><p>I kept this out of the GitHub issue tracker to keep it professional but that comment made me realize that I cared too much about what people think of
my project so it can gain more popularity.</p><blockquote><p><strong>This is in no way an invitation to harass the author of the issue and is only my thoughts on the matter.</strong></p></blockquote><p>That is all for now, have a nice day ðŸ˜€.</p></article></main><footer>Â© 2023 Aakash Sen Sharma
<a rel=license href=http://creativecommons.org/licenses/by/3.0/us/><img alt="Creative Commons License" src=https://i.creativecommons.org/l/by/3.0/us/80x15.png></a></footer></div></body></html>
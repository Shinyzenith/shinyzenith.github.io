<!doctype html><html><head><meta charset=utf-8><title>UNIX domain socket IPC in Rust. Â· Shinyzenith</title><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=canonical href=https://aakash.is-a.dev/blog/2022/unix-domain-socket-ipc-in-rust./><meta name=author content="Aakash Sen Sharma"><link rel=stylesheet href=https://aakash.is-a.dev/node_modules/normalize.css/normalize.css><link rel=stylesheet href=https://aakash.is-a.dev/node_modules/firacode/distr/fira_code.css><link rel=stylesheet href=https://aakash.is-a.dev/css/nanum-gothic-coding.css><link rel=stylesheet href=https://aakash.is-a.dev/css/style.css></head><body><header><h1>ç©º</h1></header><div id=main><nav><a href=https://aakash.is-a.dev/>Home</a> &#183;
<a href=https://aakash.is-a.dev/blog>Blog</a> &#183;
<a rel=me href=https://aakash.is-a.dev/about>About</a> &#183;
<a rel=me href=https://github.com/shinyzenith>GitHub</a> &#183;
<a rel=me href=https://fosstodon.org/@shinyzenith>Mastodon</a></nav><main><article><header><h1>UNIX domain socket IPC in Rust.</h1><time datetime=2022-02-08T00:00:00Z>2022-02-08</time></header><p>The <a href=https://github.com/waycrate/swhkd/pull/10>IPC patch</a> is complete and has been merged into the main branch.</p><p>The patch was made possible with the <a href=https://crates.io/crates/interprocess>interprocess crate</a> and was later rewritten to raw stdlib implementation
in <a href=https://github.com/waycrate/swhkd/commit/35d4960d87b8e2ac6e8a32fd642b1f7555f3ec2a>this commit</a>. Currently the server binary (<code>swhks</code>) makes a
socket at <code>/run/user/(YourUserID)/swhkd.sock</code> which then the daemon binary (<code>swhkd</code>) tries to establish a connection with.</p><p>After merging the initial set of patches <a href=https://github.com/unsignedarduino>Ckyiu</a> found 2 issues right away:</p><ul><li><p>Calling the function <code>physical_path()</code> on any <code>evdev::Device</code> object returns None on virtual machines and hence the binary panics and crashes while
attempting to execute <code>.unwrap()</code> on it. This issue has been taken care of in this <a href=https://github.com/waycrate/swhkd/commit/1e01014a1436a3983f09c57574b0bca4ff5adfcb>commit.</a></p></li><li><p>The old error message &ldquo;Invoking user is NOT in input group.&rdquo; would lead users to add themselves to the input group, and we definitely don&rsquo;t want that
as stated in the <a href=https://shinyzenith.xyz/blogs/swhkd_rust_rewrite/>previous blog</a>. To counter this issue, <a href=https://github.com/waycrate/swhkd/commit/faecfcf61784a1dfe3c43fa8b4ca303c5b3137b5>swhkd now warns the user</a> if they have input group access and gracefully exits.</p></li></ul><p>All that remains now is config file handling which has been assigned to <a href=https://angelo.is-a.dev/>Angelo Fallaria</a>, and key event handling which I will
be implementing.</p><p>That is all for now ðŸ˜€.</p></article></main><footer>Â© 2023 Aakash Sen Sharma
<a rel=license href=http://creativecommons.org/licenses/by/3.0/us/><img alt="Creative Commons License" src=https://i.creativecommons.org/l/by/3.0/us/80x15.png></a></footer></div></body></html>
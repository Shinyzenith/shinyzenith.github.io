<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>NextWM! | Shinyzenith</title><meta name=keywords content="Python,Wayland"><meta name=description content="Choosing a language: Hi! in my current quest of writing a useable wayland compositing window manager I have gone down a deep rabbit hole.
The wlroots repository lists the following wrapper libraries:
Chicken Scheme, Common Lisp, Go, Godot, Haskell, OCaml, Python, Qt, Rust, Swift, Zig
Don&rsquo;t be fooled by this list! All of these wrapper libraries are unmaintained apart from Python and Zig üòî.
With the above in mind, I have tried multiple languages to write a compositor with and here are my cumulative thoughts:"><meta name=author content="Aakash Sen Sharma"><link rel=canonical href=https://aakash.is-a.dev/blogs/nextwm/><link crossorigin=anonymous href=/assets/css/stylesheet.89ddf811fb89bdeb675879472dc6f632c797b293420d62904ae8523a6a66c92e.css integrity="sha256-id34EfuJvetnWHlHLcb2MseXspNCDWKQSuhSOmpmyS4=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href="https://avatars.githubusercontent.com/u/60808802?v=4"><link rel=icon type=image/png sizes=16x16 href="https://avatars.githubusercontent.com/u/60808802?v=4"><link rel=icon type=image/png sizes=32x32 href="https://avatars.githubusercontent.com/u/60808802?v=4"><link rel=apple-touch-icon href="https://avatars.githubusercontent.com/u/60808802?v=4"><link rel=mask-icon href="https://avatars.githubusercontent.com/u/60808802?v=4"><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="NextWM!"><meta property="og:description" content="Choosing a language: Hi! in my current quest of writing a useable wayland compositing window manager I have gone down a deep rabbit hole.
The wlroots repository lists the following wrapper libraries:
Chicken Scheme, Common Lisp, Go, Godot, Haskell, OCaml, Python, Qt, Rust, Swift, Zig
Don&rsquo;t be fooled by this list! All of these wrapper libraries are unmaintained apart from Python and Zig üòî.
With the above in mind, I have tried multiple languages to write a compositor with and here are my cumulative thoughts:"><meta property="og:type" content="article"><meta property="og:url" content="https://aakash.is-a.dev/blogs/nextwm/"><meta property="og:image" content="https://aakash.is-a.dev/"><meta property="article:section" content="blogs"><meta property="article:published_time" content="2022-06-04T00:00:00+00:00"><meta property="article:modified_time" content="2022-06-04T00:00:00+00:00"><meta property="og:site_name" content="Aakash Sharma"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://aakash.is-a.dev/"><meta name=twitter:title content="NextWM!"><meta name=twitter:description content="Choosing a language: Hi! in my current quest of writing a useable wayland compositing window manager I have gone down a deep rabbit hole.
The wlroots repository lists the following wrapper libraries:
Chicken Scheme, Common Lisp, Go, Godot, Haskell, OCaml, Python, Qt, Rust, Swift, Zig
Don&rsquo;t be fooled by this list! All of these wrapper libraries are unmaintained apart from Python and Zig üòî.
With the above in mind, I have tried multiple languages to write a compositor with and here are my cumulative thoughts:"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blogs","item":"https://aakash.is-a.dev/blogs/"},{"@type":"ListItem","position":2,"name":"NextWM!","item":"https://aakash.is-a.dev/blogs/nextwm/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"NextWM!","name":"NextWM!","description":"Choosing a language: Hi! in my current quest of writing a useable wayland compositing window manager I have gone down a deep rabbit hole.\nThe wlroots repository lists the following wrapper libraries:\nChicken Scheme, Common Lisp, Go, Godot, Haskell, OCaml, Python, Qt, Rust, Swift, Zig\nDon\u0026rsquo;t be fooled by this list! All of these wrapper libraries are unmaintained apart from Python and Zig üòî.\nWith the above in mind, I have tried multiple languages to write a compositor with and here are my cumulative thoughts:","keywords":["Python","Wayland"],"articleBody":" Choosing a language: Hi! in my current quest of writing a useable wayland compositing window manager I have gone down a deep rabbit hole.\nThe wlroots repository lists the following wrapper libraries:\nChicken Scheme, Common Lisp, Go, Godot, Haskell, OCaml, Python, Qt, Rust, Swift, Zig\nDon‚Äôt be fooled by this list! All of these wrapper libraries are unmaintained apart from Python and Zig üòî.\nWith the above in mind, I have tried multiple languages to write a compositor with and here are my cumulative thoughts:\nC: I simply don‚Äôt want to write my compositor in C as it‚Äôs easy to shoot yourself in the foot with it.\nC++: Same reasons as C, and on top of that importing wlroots headers into C++ in itself is a messy task including prepocessor re-definitions etc.\nNim: It was initially working till it didn‚Äôt‚Ä¶\nI‚Äôm still not quite sure why the callbacks that I had registered didn‚Äôt work.\nIf you do, feel free to reach out to me via Email or via GitHub issue.\nZig: Zig is a fine language to use for compositors given the amazing work @Ifreund has put in which includes but is not limited to:\nZig-pixman - Pixman bindings. Zig-wayland - Libwayland bindings. Zig-wlroots - Wlroots bindings. Zig-xkbcommon - Xkbcommon bindings. That being said, Zig is still an unstable language which hasn‚Äôt even had a 1.0 release yet.\nHence I don‚Äôt want to commit to writing my entire stack in Zig just yet.\nI am however writing a small helper screenshot utility in Zig (wayshot clone) for teaching myself and others who want to learn more about the wayland ecosystem.\nRust: Although Smithay isn‚Äôt the same as wlroots, it‚Äôs still a worthy candidate to mention on this list due to the fact that you can write compositors which are just as functional with it too.\nI‚Äôve recently started contributing to wayland-rs and smithay-client-toolkit and you should too! they‚Äôre in need of more contributors and as you can imagine, maintaining pure rust libwayland bindings is a herculean task.\nThe devs have been nothing but patient with me even when I asked stupid questions over and over again in their matrix channel.\nAll of my wayland knowledge comes from writing numerous wayland clients with wayland-rs and talking to cmeissl, i509VCB and Victor Berger from the smithay team.\nThat being said, Smithay just isn‚Äôt as mature as wlroots yet. A lot more manual labor is needed just for the tinywl equivalent of wlroots in smithay‚Ä¶you can assume how much it would scale up for a proper usable compositor (None written in smithay yet). This paird with the fact that the wayland-rs API is undergoing a massive breaking change for release candidate 0.3.0, makes it too volatile to commit to in terms of server side just yet.\nHowever, client side API won‚Äôt change too much with release candidate 0.3.0 and I‚Äôd say it‚Äôs a pleasant experience to write wayland clients in rust.\nOn a separate note, check out the Jay compositor. I think the dev is on crack? they implemented practically everything on their own:\nWayland protocol. Wire protocol. Dbus interface. EGL wrapper. GBM wrapper. OpenGL renderer. The project doesn‚Äôt even depend on libwayland!!! ü§Øü§Øü§Ø\nPython: Python to me is a first class candidate for writing compositors. It‚Äôs not easy to shoot yourself in the foot with, simple enough to write and most importantly, it has maintained bindings.\nThe question might arise ‚ÄúWhat will you do when the bindings are no longer maintained?‚Äù.\nI don‚Äôt think qtile will become irrelevant anytime soon hence the bindings will stay maintained for a long time.\n‚ÄúWhat does qtile have to do with wlroots python bindings?‚Äù, pywlroots and pywayland are both maintained by Sean Vig from the qtile team!\nThe Verdict: It should come of no surprise to you that I picked python. I have created the repo and invited a friend of mine to develop NextWM with me.\nSource Code Availability and Support: I will follow through with one of the following:\nKeep the source private until get paid to release it. If I do get paid, I will provide 100% support for the lifetime of the project. This is because I‚Äôm tired of offering my free labor, I write my software to teach myself and use in my workflow and not to provide support for other issues which are irrelevant to my usecase.\nKeep the code open-source under 0BSD license and stop giving a fuck about bug reports/feature requests I get which are irrelevant to me unless I get paid to escalate their priority. I made the mistake of caring too much with swhkd and instead got back github issues like such: ‚Äúsee man sxhkd to know other modifiers that sxhkd support instead of waiting people to report them one by one‚Äù\nI‚Äôm sorry but I wrote swhkd for my usecase as I needed a hotkey daemon and I bind features as and when requested if I don‚Äôt need them already. I don‚Äôt like that attitude.\nI kept this out of the GitHub issue tracker to keep it professional but that comment made me realize that I cared too much about what people think of my project so it can gain more popularity.\nThis is in no way an invitation to harass the author of the issue and is only my thoughts on the matter.\nThat is all for now, have a nice day üòÄ.\n","wordCount":"899","inLanguage":"en","datePublished":"2022-06-04T00:00:00Z","dateModified":"2022-06-04T00:00:00Z","author":[{"@type":"Person","name":"Aakash Sen Sharma"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://aakash.is-a.dev/blogs/nextwm/"},"publisher":{"@type":"Organization","name":"Shinyzenith","logo":{"@type":"ImageObject","url":"https://avatars.githubusercontent.com/u/60808802?v=4"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://aakash.is-a.dev/ accesskey=h title="  (Alt + H)"></a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://github.com/Shinyzenith title=GitHub><span>GitHub</span></a></li><li><a href=mailto:aakash@shinyzenith.xyz title=Email><span>Email</span></a></li><li><a href=https://aakash.is-a.dev/pgp title=PGP><span>PGP</span></a></li><li><a href=https://aakash.is-a.dev/tags title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://aakash.is-a.dev/>Home</a>&nbsp;¬ª&nbsp;<a href=https://aakash.is-a.dev/blogs/>Blogs</a></div><h1 class=post-title>NextWM!</h1><div class=post-meta><span title='2022-06-04 00:00:00 +0000 UTC'>June 4, 2022</span>&nbsp;¬∑&nbsp;5 min&nbsp;¬∑&nbsp;899 words&nbsp;¬∑&nbsp;Aakash Sen Sharma</div></header><div class=post-content><hr><h1 id=choosing-a-language>Choosing a language:<a hidden class=anchor aria-hidden=true href=#choosing-a-language>#</a></h1><p>Hi! in my current quest of writing a useable wayland compositing window manager I have gone down a deep rabbit hole.</p><p>The wlroots repository lists the following wrapper libraries:</p><blockquote><p><code>Chicken Scheme</code>, <code>Common Lisp</code>, <code>Go</code>, <code>Godot</code>, <code>Haskell</code>, <code>OCaml</code>, <code>Python</code>, <code>Qt</code>, <code>Rust</code>, <code>Swift</code>, <code>Zig</code></p></blockquote><p>Don&rsquo;t be fooled by this list! All of these wrapper libraries are unmaintained apart from Python and Zig üòî.</p><p>With the above in mind, I have tried multiple languages to write a compositor with and here are my cumulative thoughts:</p><h2 id=c>C:<a hidden class=anchor aria-hidden=true href=#c>#</a></h2><p>I simply don&rsquo;t want to write my compositor in C as it&rsquo;s easy to shoot yourself in the foot with it.</p><h2 id=c-1>C++:<a hidden class=anchor aria-hidden=true href=#c-1>#</a></h2><p>Same reasons as C, and on top of that importing wlroots headers into C++ in itself is a <a href=https://github.com/swaywm/wlroots/issues/682>messy</a> task
including prepocessor re-definitions etc.</p><h2 id=nim>Nim:<a hidden class=anchor aria-hidden=true href=#nim>#</a></h2><p>It was initially working till it didn&rsquo;t&mldr;</p><p>I&rsquo;m still not quite sure why the <a href="https://github.com/Shinyzenith/nim-wl/blob/devel/src/libherb.nim#L125=">callbacks</a> that I had registered didn&rsquo;t work.</p><p>If you do, feel free to reach out to me via Email or via <a href=https://github.com/Shinyzenith/nim-wl/issues/new>GitHub issue</a>.</p><h2 id=zig>Zig:<a hidden class=anchor aria-hidden=true href=#zig>#</a></h2><p>Zig is a fine language to use for compositors given the amazing work <a href=https://github.com/ifreund/>@Ifreund</a> has put in which includes but is not limited to:</p><ul><li><a href=https://github.com/ifreund/zig-pixman>Zig-pixman</a> - Pixman bindings.</li><li><a href=https://github.com/ifreund/zig-wayland>Zig-wayland</a> - Libwayland bindings.</li><li><a href=https://github.com/swaywm/zig-wlroots>Zig-wlroots</a> - Wlroots bindings.</li><li><a href=https://github.com/ifreund/zig-xkbcommon>Zig-xkbcommon</a> - Xkbcommon bindings.</li></ul><p>That being said, Zig is still an unstable language which hasn&rsquo;t even had a 1.0 release yet.</p><p>Hence I don&rsquo;t want to commit to writing my entire stack in Zig just yet.</p><p>I am however writing a small helper <a href=https://github.com/shinyzenith/zigshot>screenshot utility</a> in Zig (<a href=https://github.com/waycrate/wayshot>wayshot</a> clone) for
teaching myself and others who want to learn more about the wayland ecosystem.</p><h2 id=rust>Rust:<a hidden class=anchor aria-hidden=true href=#rust>#</a></h2><blockquote><p>Although <strong>Smithay isn&rsquo;t the same as wlroots</strong>, it&rsquo;s still a worthy candidate to mention on this list due to the fact that you can write compositors
which are <strong>just as functional</strong> with it too.</p></blockquote><p>I&rsquo;ve recently started contributing to <a href=https://github.com/smithay/wayland-rs>wayland-rs</a> and <a href=https://github.com/smithay/client-toolkit>smithay-client-toolkit</a>
and you should too! they&rsquo;re in need of more contributors and as you can imagine, maintaining pure rust libwayland bindings is a herculean task.</p><blockquote><p>The devs have been nothing but patient with me even when I asked stupid questions over and over again in their matrix channel.</p></blockquote><p>All of my wayland knowledge comes from writing numerous wayland clients with wayland-rs and talking to <a href=https://github.com/cmeissl>cmeissl</a>,
<a href=https://github.com/i509VCB>i509VCB</a> and <a href=https://github.com/vberger>Victor Berger</a> from the smithay team.</p><p>That being said, Smithay just isn&rsquo;t as mature as wlroots yet. A lot more manual labor is needed just for the tinywl equivalent of wlroots in smithay&mldr;you
can assume how much it would scale up for a proper usable compositor (None written in smithay yet). This paird with the fact that the <strong>wayland-rs API
is undergoing a massive breaking change</strong> for release candidate <strong>0.3.0</strong>, makes it too volatile to commit to in terms of server side just yet.</p><blockquote><p>However, <strong>client side API won&rsquo;t change too</strong> much with release candidate 0.3.0 and I&rsquo;d say it&rsquo;s a pleasant experience to write wayland clients in rust.</p></blockquote><blockquote><p>On a separate note, check out the <a href=https://github.com/mahkoh/jay>Jay compositor</a>. I think the dev is on crack? they implemented practically everything
on their own:</p><ul><li>Wayland protocol.</li><li>Wire protocol.</li><li>Dbus interface.</li><li>EGL wrapper.</li><li>GBM wrapper.</li><li>OpenGL renderer.</li></ul><p>The project doesn&rsquo;t even depend on libwayland!!! ü§Øü§Øü§Ø</p></blockquote><h2 id=python>Python:<a hidden class=anchor aria-hidden=true href=#python>#</a></h2><p>Python to me is a first class candidate for writing compositors. It&rsquo;s not easy to shoot yourself in the foot with, simple enough to write and most importantly,
it has <a href=https://github.com/flacjacket/pywlroots>maintained bindings</a>.</p><p>The question might arise &ldquo;What will you do when the bindings are no longer maintained?&rdquo;.</p><p>I don&rsquo;t think qtile will become irrelevant anytime soon hence the bindings will stay maintained for a long time.</p><p>&ldquo;What does qtile have to do with wlroots python bindings?&rdquo;, pywlroots and pywayland are both maintained by <a href=https://github.com/flacjacket>Sean Vig</a>
from the qtile team!</p><hr><h1 id=the-verdict>The Verdict:<a hidden class=anchor aria-hidden=true href=#the-verdict>#</a></h1><p>It should come of no surprise to you that <strong>I picked python</strong>. I have created the repo and invited a <a href=https://github.com/actualdankcoder>friend of mine</a>
to develop NextWM with me.</p><hr><h1 id=source-code-availability-and-support>Source Code Availability and Support:<a hidden class=anchor aria-hidden=true href=#source-code-availability-and-support>#</a></h1><p>I will follow through with one of the following:</p><ol><li><p>Keep the source private until get paid to release it. If I do get paid, I will provide 100% support for the lifetime of the project. This is because
<strong>I&rsquo;m tired of offering my free labor</strong>, I write my software to <strong>teach myself and use in my workflow</strong> and not to provide support for other issues
which are irrelevant to my usecase.</p></li><li><p>Keep the code open-source under <a href=https://spdx.org/licenses/0BSD.html>0BSD license</a> and stop giving a fuck about bug reports/feature requests I
get which are irrelevant to me unless I get paid to escalate their priority. I made the mistake of caring too much with <a href=https://github.com/waycrate/swhkd>swhkd</a>
and instead got back github issues like such: <a href=https://github.com/waycrate/swhkd/issues/125>&ldquo;see man sxhkd to know other modifiers that sxhkd support instead of waiting people to report them one by one&rdquo;</a></p></li></ol><p>I&rsquo;m sorry but I wrote swhkd for my usecase as I needed a hotkey daemon and I bind features as and when requested if I don&rsquo;t need them already. I
don&rsquo;t like that attitude.</p><p>I kept this out of the GitHub issue tracker to keep it professional but that comment made me realize that I cared too much about what people think of
my project so it can gain more popularity.</p><blockquote><p><strong>This is in no way an invitation to harass the author of the issue and is only my thoughts on the matter.</strong></p></blockquote><p>That is all for now, have a nice day üòÄ.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://aakash.is-a.dev/tags/python/>Python</a></li><li><a href=https://aakash.is-a.dev/tags/wayland/>Wayland</a></li></ul><nav class=paginav><a class=next href=https://aakash.is-a.dev/blogs/tinywl_nim/><span class=title>Next ¬ª</span><br><span>Wayland Compositor written in nim.</span></a></nav></footer></article></main><footer class=footer><span>Copyright &copy; 2022 <a href=https://aakash.is-a.dev/>Shinyzenith</a> | <a href=https://github.com/Shinyzenith/website target=_blank>0BSD Source Code</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>